实现一个基于web的AI生图评估试题集。用来评估某个AI生图模型的生图能力，测试包含多个维度的测试。
试题数据包括维度管理，试题管理，参考样例

试题主要内容包括：
1. 提示词
2. 考察维度列表
3. 评分标准
4. 参考样例

维度管理可以添加删除新的维度，可以定义每个维度说明，每个维度的加分项和减分项

主要是单用户内部使用。不用考虑授权等功能

目录设计
ai-image-evaluation-system/
├── package.json                     # 根 monorepo（workspaces）
├── pnpm-workspace.yaml              # workspace 配置
├── .gitignore
├── docs/                            # 文档（需求/模板/设计说明）
│   └── README.md
├── samples/                         # 示例资源（示例图片、报告样本等）
│   └── README.md
├── tools/                           # 脚本与自动化（Python/批处理等）
│   └── README.md
├── frontend/                        # 单前端应用（用路由区分 /admin 与 /eval）
│   ├── index.html
│   └── src/
│       ├── App.vue                  # 全局入口，包含顶层导航
│       ├── main.js                  # 启动入口
│       ├── router/
│       │   └── index.js             # 路由定义：/admin、/eval
│       └── views/
│           ├── AdminHome.vue        # 管理端首页（维度/试题/样例/上传入口）
│           └── EvalHome.vue         # 评估端首页（面板/列表/评分/结果）
├── backend/                         # 后端服务
│   ├── ENV.md                       # 环境变量示例说明（根 .env 建议参考此文件）
│   ├── src/
│   │   ├── routes/                  # 路由注册，仅做路由绑定
│   │   ├── controllers/             # 控制器：处理请求入参与响应
│   │   ├── services/                # 业务逻辑：供控制器调用
│   │   ├── models/                  # 数据模型（例如 Mongoose/Prisma）
│   │   ├── validators/              # 入参/数据校验（Zod/Joi）
│   │   ├── middlewares/             # 中间件：错误处理/日志/CORS/限流等
│   │   ├── utils/                   # 工具与通用函数
│   │   └── app.js                   # 应用入口
│   ├── uploads/                     # 文件上传目录（仓库忽略具体文件）
│   │   ├── .gitignore
│   │   ├── .gitkeep
│   │   ├── examples/                # 参考样例图片
│   │   └── eval-images/             # 评估生成的图片
│   └── server.js
└── shared/                          # 共享资源（常量/类型）
    ├── constants.js                 # 共享常量
    └── types.js                     # 共享类型定义

补充说明
1) 前端形态：已采用“单前端”，通过路由区分 /admin 与 /eval；如需后续拆分，可将公共组件抽取为 `packages/ui`。
2) 上传与安全：限制 MIME/体积，文件名散列与分片存储，必要时移除 EXIF；生产建议使用对象存储（如 S3/MinIO）。
3) 配置与环境：在项目根目录创建 .env（不入库），变量示例见 backend/ENV.md；不要把运行时配置放入 shared 常量。
4) 数据与迁移：尽早确定数据库（如 Mongo/Mongoose 或 Postgres+Prisma），加入迁移与种子数据（初始维度/题库/样例）。
5) 工程规范：建议补充 .editorconfig、eslint、prettier、Dockerfile、docker-compose 与 CI（lint/测试/构建/镜像）。

数据设计
一、维度数据（Dimension）
字段
1) id：string，唯一标识
2) name：string，维度名称（如“构图”、“一致性”、“光影”等）
3) description：string，维度说明（目的与考虑点）
4) bonusCriteria：string[]，加分项（关键点或提示）
5) penaltyCriteria：string[]，减分项（常见问题）
6) createdAt：string（ISO 日期），创建时间
7) updatedAt：string（ISO 日期），更新时间

示例
{
  "id": "dim_composition",
  "name": "构图",
  "description": "主体突出、元素布局合理，视觉引导清晰",
  "bonusCriteria": ["主体清晰", "中心构图或三分法构图合理"],
  "penaltyCriteria": ["主体歪斜", "画面杂乱、边角干扰"],
  "createdAt": "2025-11-18T10:00:00.000Z",
  "updatedAt": "2025-11-18T10:00:00.000Z"
}

二、试题数据（Question）
字段
1) id：string，唯一标识（UUID）
2) prompt：string，提示词
3) dimensionIds：string[]，考察维度 ID 列表（引用 Dimension.id）
4) scoringRule：string，评分规则文字（简明描述；如需更复杂可扩展为结构化）
5) exampleIds：string[]，参考样例 ID 列表（引用 Example.id，样例数据在后续补充）
6) createdAt：string（ISO 日期），创建时间
7) updatedAt：string（ISO 日期），更新时间

示例
{
  "id": "q_city_sunrise_001",
  "prompt": "一幅清晨城市日出，暖色调，强调光影层次与建筑剪影",
  "dimensionIds": ["dim_composition", "dim_lighting", "dim_consistency"],
  "scoringRule": "每个维度 0-10 分，综合取平均；若存在明显穿帮则扣 2-5 分",
  "exampleIds": ["ex_city_sunrise_a", "ex_city_sunrise_b"],
  "createdAt": "2025-11-18T10:00:00.000Z",
  "updatedAt": "2025-11-18T10:00:00.000Z"
}

备注
- 评分建议按维度独立打分（0-10），可在后端配置权重做加权平均。
- 与 `shared/types.js` 保持一致；后续若引入更复杂评分，可扩展 `scoringRule` 为结构化字段（如每维度规则与权重）。
 - 从现在起新建试题的 id 采用 UUID；旧数据仍可保留原有 ID，不影响引用与导出。如需一键迁移为 UUID，我可以提供脚本同时更新 `questions.json` 与 `questionSets.json` 的引用关系。

数据存储（JSON 文件）
选择：不使用数据库，采用本地 JSON 文件持久化，适合小规模单用户场景。

路径结构
backend/
├── data/
│   ├── dimensions.json     # 维度列表（数组）
│   ├── questions.json      # 试题列表（数组）
│   ├── examples.json       # 样例列表（数组）
│   └── evaluations.json    # 评估记录（数组）
└── uploads/
    ├── examples/           # 样例图片文件
    └── eval-images/        # 评估生成图片文件

管理端导航
- /admin 进入后提供功能选择：
  - 维度编辑（增/删/改维度及其加减分项）
  - 试题集管理（创建/编辑试题集的总信息：名称、说明、使用的维度、创建时间等；后续可在试题集内维护试题列表）

三、试题集数据（QuestionSet）
字段
1) id：string，唯一标识
2) name：string，名称
3) description：string，说明
4) dimensionIds：string[]，本试题集所采用的维度集合（引用 Dimension.id）
5) questionIds?: string[]，可选，本试题集包含的试题 ID（引用 Question.id）
6) createdAt：string（ISO 日期），创建时间
7) updatedAt：string（ISO 日期），更新时间

示例
{
  "id": "set_landscape_basic",
  "name": "风景基础测评集",
  "description": "用于基础风景类题目的构图/光影/一致性评估",
  "dimensionIds": ["dim_composition", "dim_lighting", "dim_consistency"],
  "questionIds": ["q_city_sunrise_001"],
  "createdAt": "2025-11-18T11:00:00.000Z",
  "updatedAt": "2025-11-18T11:00:00.000Z"
}

评估保留与导出
目标
- 每次评估的“生成图片 + 评分信息”都持久化，支持历史查看与导出；导出是“一次完整评估”。

数据结构（EvaluationItem：题目级记录）
字段
1) id：string，唯一标识
2) runId：string，关联“评估批次”
3) questionId：string，关联试题
4) generatedImagePath：string，AI 生成图片的相对路径（存于 uploads/eval-images/）
5) scoresByDimension：Record<string, number>，维度到分值的映射（0-10）
6) comment：string，可选评语
7) createdAt：string（ISO 日期），创建时间

示例
{
  "id": "ev_20251118_0001",
  "runId": "run_20251118_city_v15",
  "questionId": "q_city_sunrise_001",
  "generatedImagePath": "backend/uploads/eval-images/2025/11/18/ab/cd/abcdef123456.webp",
  "scoresByDimension": { "dim_composition": 8, "dim_lighting": 7, "dim_consistency": 9 },
  "comment": "整体较好，光影还可更通透",
  "createdAt": "2025-11-18T10:05:00.000Z"
}

数据结构（EvaluationRun：整次评估/导出单位）
字段
1) id：string，唯一标识（如 run_日期_模型名_版本）
2) modelName：string，模型名称（可含版本号）
3) itemIds：string[]，本次评估关联的题目级记录 ID 列表（EvaluationItem.id）
4) totalScore：number，总分（按维度加权或平均汇总）
5) dimensionScores：Record<string, number>，各维度总分/平均分
6) startedAt：string，开始时间
7) endedAt：string，结束时间
8) exportFiles?: { json?: string, csv?: string, zip?: string } 导出产物相对路径（可选）

示例
{
  "id": "run_20251118_city_v15",
  "modelName": "MyGenModel v1.5",
  "itemIds": ["ev_20251118_0001", "ev_20251118_0002"],
  "totalScore": 8.1,
  "dimensionScores": { "dim_composition": 8.3, "dim_lighting": 7.9, "dim_consistency": 8.2 },
  "startedAt": "2025-11-18T10:00:00.000Z",
  "endedAt": "2025-11-18T10:20:00.000Z",
  "exportFiles": {
    "json": "backend/exports/run_20251118_city_v15/run.json",
    "csv": "backend/exports/run_20251118_city_v15/scores.csv",
    "zip": "backend/exports/run_20251118_city_v15.zip"
  }
}

导出与回看
- 历史查看：前端提供“评估历史（按批次）”页面（按时间/模型筛选），并可展开查看题目级记录。
- 导出格式：
  - JSON（run.json）：包含 EvaluationRun 与其下全部 EvaluationItem（含题面、评分、图片路径）
  - CSV（scores.csv）：维度与题目评分汇总（不含图片）
  - ZIP：包含 JSON/CSV 与本批次所涉图片文件
- 文件命名：基于日期 + 短哈希；图片路径使用日期分片 + 哈希（便于清理与排查）。

目录补充
- 后端新增导出目录：backend/exports/（生成的导出包，仓库忽略）
- 前端可新增页面：
  - views/EvaluationList.vue（历史列表/筛选/查看详情）
  - views/Report.vue（导出入口，预览统计）

JSON 约定
- 文件为 UTF-8，最外层为数组，每项一个实体对象（与“数据设计”字段一致）。
- 图片仅存路径（相对仓库或相对后端工作目录）。
- 写入采用原子写（临时文件 + 重命名），避免部分写入导致损坏。

并发与备份
- 单用户离线/内网使用，低并发，直接文件锁/原子写足够。
- 建议定期备份 `backend/data/` 与 `backend/uploads/`；生产可切换到对象存储/云盘。
